!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Store=e():t.Store=e()}(window,(function(){return function(t){var e={};function s(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,s),i.l=!0,i.exports}return s.m=t,s.c=e,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(n,i,function(e){return t[e]}.bind(null,i));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";var n,i,r,a=this&&this.__classPrivateFieldSet||function(t,e,s){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,s),s},o=this&&this.__classPrivateFieldGet||function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},h=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const c=h(s(1));class u{constructor(t,e="clinfc-store"){this.storage=t,this.namespace=e,n.set(this,Math.random().toString(16).slice(2,12)),i.set(this,void 0),r.set(this,{}),this.events=new c.default,a(this,i,"local"===t?window.localStorage:window.sessionStorage),this.synchrodata(!1);const s=t=>{t.key===this.namespace&&this.synchrodata(!1)},h=t=>{t.detail&&t.detail.namespace===this.namespace&&(t.detail.uuid!==o(this,n)&&this.synchrodata(!1),this.events.emeit("change"))};window.addEventListener("storage",s),window.addEventListener(this.storage+"storagechange",h),this.events.once("destory",()=>{window.removeEventListener("storage",s),window.removeEventListener(this.storage+"storagechange",h)})}get data(){return o(this,r)}get size(){return this.keys().length}keys(){return Object.keys(o(this,r))}has(t){return t in o(this,r)}get(t){return this.has(t)?o(this,r)[t]:null}gets(...t){const e={};return t.forEach(t=>{e[t]=this.get(t)}),e}only(...t){const e={};return t.forEach(t=>{this.has(t)&&(e[t]=this.get(t))}),e}set(t,e){return o(this,r)[t]=e,this.synchrodata(!0),this.dispatch(),this}sets(t){const e=Object.entries(t);return e.length&&(e.forEach(([t,e])=>{o(this,r)[t]=e}),this.synchrodata(!0),this.dispatch()),this}remove(...t){return(t=t.filter(t=>this.has(t))).length&&(t.forEach(t=>{delete o(this,r)[t]}),this.synchrodata(!0),this.dispatch()),this}clear(){return a(this,r,{}),o(this,i).removeItem(this.namespace),this.dispatch(),this}destroy(){this.events.emeit("destory"),this.events.clear(),a(this,r,{})}dispatch(){const t=new CustomEvent(this.storage+"storagechange",{bubbles:!0,cancelable:!0,detail:{uuid:o(this,n),namespace:this.namespace}});window.dispatchEvent(t)}synchrodata(t=!0){if(t)o(this,i).setItem(this.namespace,JSON.stringify(o(this,r)));else{const t=o(this,i).getItem(this.namespace);t&&/^\{.*\}$/.test(t)?a(this,r,JSON.parse(t)):a(this,r,{})}}static session(t){return new u("session",t)}static local(t){return new u("local",t)}}e.default=u,n=new WeakMap,i=new WeakMap,r=new WeakMap},function(t,e,s){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.EventStatus=void 0,function(t){t[t.NEXT=0]="NEXT",t[t.END=1]="END",t[t.DELETE=2]="DELETE",t[t.DELETE_AND_END=3]="DELETE_AND_END"}(n=e.EventStatus||(e.EventStatus={}));e.default=class{constructor(){this.data=new Map}add(t,e){this.data.has(t)||this.data.set(t,[]),this.data.get(t).push(e)}forEach(t,e){if(this.data.has(t)){const s=this.data.get(t);for(let t=0;t<s.length;t++){const i=e(s[t],t);if(n.END==i)break;if(n.DELETE==i)s.splice(t--,1);else if(n.DELETE_AND_END==i){s.splice(t--,1);break}}}}on(t,e){return this.add(t,{fn:e,once:!1}),this}once(t,e){return this.add(t,{fn:e,once:!0}),this}emeit(t,...e){return this.forEach(t,({fn:t,once:s})=>{if(t(...e),s)return n.DELETE}),this}off(t,e){return this.forEach(t,({fn:t})=>{if(e===t)return n.DELETE_AND_END}),this}remove(t){return this.data.delete(t),this}clear(){return this.data.clear(),this}}}]).default}));
//# sourceMappingURL=index.min.js.map